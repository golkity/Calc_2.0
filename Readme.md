# Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»Ñ‘Ğ½Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒ Ğ°Ñ€Ğ¸Ñ„Ğ¼ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ 
![version](https://shields.microej.com/github/go-mod/go-version/golkity/Calc?style=for-the-badge)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg?style=for-the-badge)](LICENSE)
[![GitHub Repo stars](https://img.shields.io/github/stars/USERNAME/REPOSITORY?style=social)](https://github.com/golkity/YandexGo)

![intro](source/logo_int.png)

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

<pre>
app/
â”œâ”€â”€ cmd
â”‚   â”œâ”€â”€ agent
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â””â”€â”€ orchestrator
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ config
â”‚   â”œâ”€â”€ config.json
â”‚   â””â”€â”€ config.go
â”œâ”€â”€ internal
â”‚   â”œâ”€â”€ applicant
â”‚   â”‚   â”œâ”€â”€ agent_app.go
â”‚   â”‚   â””â”€â”€ orchen_app.go
â”‚   â”œâ”€â”€ agent
â”‚   â”‚   â””â”€â”€ agetn.go
â”‚   â”œâ”€â”€ custom_errors
â”‚   â”‚   â””â”€â”€ custom_errors.go
â”‚   â”œâ”€â”€ http
â”‚   â”‚   â”œâ”€â”€ handler.go
â”‚   â”‚   â””â”€â”€ handler_test.go
â”‚   â”œâ”€â”€ middleware
â”‚   â”‚   â””â”€â”€ middleware.go
â”‚   â”œâ”€â”€ orchestrator
â”‚   â”‚   â””â”€â”€ orchenstrator.go
â”‚   â”œâ”€â”€ store
â”‚   â”‚   â””â”€â”€ store.go
â”‚   â””â”€â”€ task
â”‚       â””â”€â”€ manager_tasks
â”‚       â”‚   â””â”€â”€ struct_manager.go
â”‚       â””â”€â”€ manager.go
â”œâ”€â”€ pkg
â”‚   â”œâ”€â”€ calc
â”‚   â”‚   â”œâ”€â”€calc_test.go
â”‚   â”‚   â””â”€â”€ calc.go
â”‚   â”‚   
â”‚   â””â”€â”€ logger
â”‚       â””â”€â”€ logger.go
â”œâ”€â”€ source
â”‚   â””â”€â”€ intro.png
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â””â”€â”€ README.md
</pre>

## Ğ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ

>[!IMPORTANT]
> ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸ ÑĞ¾ÑÑ‚Ğ¾Ğ¸Ñ‚ Ğ¸Ğ· Ğ´Ğ²ÑƒÑ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµÑ‚Ğ¾Ğ²:
> - ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€
> - ĞĞ³ĞµĞ½Ñ‚

### **ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€**

- ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Ñ‡ĞµÑ€ĞµĞ· `POST /api/v1/calculate`).
- Ğ Ğ°Ğ·Ğ±Ğ¸Ğ²Ğ°ĞµÑ‚ (Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸) Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸.
- Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸, Ğ¾Ğ¶Ğ¸Ğ´Ğ°ÑÑ‰Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸.
- ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ°Ğ³ĞµĞ½Ñ‚Ñƒ Ğ¿Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑƒ `GET /internal/task`.
- ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğ¹ (Ñ‡ĞµÑ€ĞµĞ· `POST /internal/task`).
- Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¿Ğ¾ `GET /api/v1/expressions` (Ğ¸ `GET /api/v1/expressions/:id`).

## ĞĞ³ĞµĞ½Ñ‚

- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ñ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ² (`COMPUTING_POWER`).
- ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ³Ğ¾Ñ€ÑƒÑ‚Ğ¸Ğ½Ğ° (Ğ²Ğ¾Ñ€ĞºĞµÑ€) Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾ ÑĞ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ñƒ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°: Â«Ğ•ÑÑ‚ÑŒ Ğ»Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°?Â» (Ğ¼ĞµÑ‚Ğ¾Ğ´ `GET /internal/task`).
- Ğ•ÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°, Ğ°Ğ³ĞµĞ½Ñ‚ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ ĞµÑ‘ (ÑĞ¼ÑƒĞ»Ğ¸Ñ€ÑƒĞµÑ‚ "Ğ´Ğ¾Ğ»Ğ³Ğ¾Ğµ" Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ, Ğ¼Ğ¾Ğ¶ĞµÑ‚ "ÑĞ¿Ğ°Ñ‚ÑŒ" `operation_time`).
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñƒ (`POST /internal/task`).
- ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ.

```mermaid
sequenceDiagram
    participant U as ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
    participant O as ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€
    participant A as ĞĞ³ĞµĞ½Ñ‚

    %% Ğ¨Ğ°Ğ³ 1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ
    U->>O: POST /api/v1/calculate\nexpression: "2+2+2"
    O-->>U: 201 id: "1"

    %% Ğ¨Ğ°Ğ³ 2. ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ¸Ñ… Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
    O->>O: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ

    %% Ğ¨Ğ°Ğ³ 3. ĞĞ³ĞµĞ½Ñ‚ (Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ¾Ñ€ĞºĞµÑ€Ğ¾Ğ²) Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
    par Ğ’Ğ¾Ñ€ĞºĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ÑÑ‚ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ
       A->>O: GET /internal/task
       O-->>A: Task: id=1, arg1="2+2+2", ...
    and
       A->>O: POST /internal/task\nid: 1, result: 6
       O->>O: ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¸ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
    end

    %% Ğ¨Ğ°Ğ³ 4. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
    U->>O: GET /api/v1/expressions/1
    O-->>U: 200 id: "1", status: "done", result: 6
```



## Ğ—Ğ°Ğ¿ÑƒÑĞº

>[!IMPORTANT]
> **Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· Docker ğŸ³:**
> ```shell
> docker-compose up --build
> ```
> 
> **Ğ—Ğ°Ğ¿ÑƒÑ agent.go**
> ```shell
> cd cmd/agent
> go run main.go
>```
> Ğ—Ğ°Ğ¿ÑƒÑĞº orchenstrator.go
> ```shell
> cd cmd/orchenstrator
> go run main.go
> ```

![logo_out](source/logo_out.png)